{% extends 'base.html' %}
{% load static %}
{% block title %} ë‚´ ê³„ì • | ë¸”ë£¨ë¬´ë¸Œ ë‹¥ìŠ¤ {% endblock %}
{% block content %}
{% include 'shared/_navbar4home.html' %}
<main class="px-2 px-md-5">
    <div class="container-md mt-5 table-responsive">
        <h1 class="mb-4 pb-2" style="font-weight: 600; color: #58595B;">ğŸ’™ ë‚´ ê³„ì •</h1>
        <div class="callout callout-dark" style="word-break: break-word;">
            <span style="font-weight: 600; color: #58595B;"><i class="fas fa-user-times"></i> íšŒì› ì •ë³´ ì‚­ì œ</span><br>
            <small style="color: #6C757D;">íšŒì› ì •ë³´ ì‚­ì œ ì‹œ ë¸”ë£¨ë¬´ë¸Œ ë‹¥ìŠ¤ì— ì €ì¥ëœ {{ user.email }} ê³„ì • ì •ë³´ì™€ ì•„ë˜ ì•ˆë‚´ëœ ìë£Œê°€ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.</small>
        </div>

        <!-- ë¸”ë£¨ë¬´ë²„ì¼ ê²½ìš° -->
        {% if user.profile.level == 'bluemover' %}
            <div class="container-md px-0">
                <div class="mt-4">
                    <div class="row row-cols-1 row-cols-lg-2 g-4">
                        <div class="col">
                            <div class="shadow-sm h-100">
                                <div class="card-body">
                                    <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“¢ ì‚­ì œë  ê³µì§€ì‚¬í•­</h5>
                                    <p class="card-text">
                                        {% if my_notices %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  <b>ê³µì§€ì‚¬í•­ {{ my_notices|length }}ê°œ</b>ê°€ ì‚­ì œë  ì˜ˆì •ì…ë‹ˆë‹¤.
                                        {% else %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="shadow-sm h-100">
                                <div class="card-body">
                                    <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ’¬ ì‚­ì œë  ëŒ“ê¸€</h5>
                                    <p class="card-text">
                                        {% if my_comments %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  <b>ëŒ“ê¸€ {{ my_comments|length }}ê°œ</b>ê°€ ì‚­ì œë  ì˜ˆì •ì…ë‹ˆë‹¤.
                                        {% else %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                        {% if my_boxes|length > 0 %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body" style="background-color: #f8d7da;">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“ ë¬¸ì„œí•¨ ì‚­ì œ í•„ìš”</h5>
                                        <p class="card-text">
                                            íšŒì› ì •ë³´ë¥¼ ì‚­ì œí•˜ì‹œë ¤ë©´
                                            {{ user.first_name }}ë‹˜ì´ ìƒì„±í•˜ì‹  <b>ë¬¸ì„œí•¨ {{ my_boxes|length }}ê°œ</b>ë¥¼
                                            ë¨¼ì € ì‚­ì œí•´ì£¼ì„¸ìš”.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“ ì‚­ì œë  ë¬¸ì„œí•¨</h5>
                                        <p class="card-text">
                                            {{ user.first_name }}ë‹˜ì´ ìƒì„±í•˜ì‹  ë¬¸ì„œí•¨ì´ ì—†ìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if my_docs_return %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ì‚­ì œë  ë¬¸ì„œ</h5>
                                        <p class="card-text">
                                            {% if user.profile.level == 'bluemover' %}
                                                ìŠ¹ì¸ëœ ë¬¸ì„œëŠ”
                                            {% else %}
                                                ë°˜í™˜ëœ ë¬¸ì„œëŠ”
                                            {% endif %}
                                            íšŒì› ì •ë³´ ì‚­ì œì˜ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% elif my_docs_create or my_docs_submit or my_docs_reject %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body" style="background-color: #f8d7da;">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ë¬¸ì„œ ì²˜ë¦¬ í•„ìš”</h5>
                                        <p class="card-text">
                                            íšŒì› ì •ë³´ë¥¼ ì‚­ì œí•˜ì‹œë ¤ë©´ {{ user.first_name }}ë‹˜ì˜
                                            {% if my_docs_create %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_submit %}
                                                <b>ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_reject %}
                                                <b>ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_submit %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_reject %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_submit and my_docs_reject %}
                                                <b>ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_submit and my_docs_reject %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% endif %}
                                            ë¨¼ì € ì²˜ë¦¬í•´ì£¼ì„¸ìš”.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ì‚­ì œë  ë¬¸ì„œ</h5>
                                        <p class="card-text">
                                            {{ user.first_name }}ë‹˜ì´ ìƒì„±í•˜ì‹  ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        <!-- ê²ŒìŠ¤íŠ¸ì¼ ê²½ìš° -->
        {% elif user.profile.level == 'guest' %}
            <div class="container-md mb-1 px-0">
                <div class="mt-4">
                    <div class="row row-cols-1 row-cols-lg-2 g-4">
                        <div class="col">
                            <div class="shadow-sm h-100">
                                <div class="card-body">
                                    <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ’¬ ì‚­ì œë  ëŒ“ê¸€</h5>
                                    <p class="card-text">
                                        {% if my_comments %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  <b>ëŒ“ê¸€ {{ my_comments|length }}ê°œ</b>ê°€ ì‚­ì œë  ì˜ˆì •ì…ë‹ˆë‹¤.
                                        {% else %}
                                            {{ user.first_name }}ë‹˜ì´ ì‘ì„±í•˜ì‹  ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.
                                        {% endif %}
                                    </p>
                                </div>
                            </div>
                        </div>
                        {% if my_docs_return %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ì‚­ì œë  ë¬¸ì„œ</h5>
                                        <p class="card-text">
                                            {% if user.profile.level == 'bluemover' %}
                                                ìŠ¹ì¸ëœ ë¬¸ì„œëŠ”
                                            {% else %}
                                                ë°˜í™˜ëœ ë¬¸ì„œëŠ”
                                            {% endif %}
                                            íšŒì› ì •ë³´ ì‚­ì œì˜ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% elif my_docs_create or my_docs_submit or my_docs_reject %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body" style="background-color: #f8d7da;">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ë¬¸ì„œ ì²˜ë¦¬ í•„ìš”</h5>
                                        <p class="card-text">
                                            íšŒì› ì •ë³´ë¥¼ ì‚­ì œí•˜ì‹œë ¤ë©´ {{ user.first_name }}ë‹˜ì˜
                                            {% if my_docs_create %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_submit %}
                                                <b>ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_reject %}
                                                <b>ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_submit %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_reject %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_submit and my_docs_reject %}
                                                <b>ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% elif my_docs_create and my_docs_submit and my_docs_reject %}
                                                <b>ë¯¸ì œì¶œ ë¬¸ì„œ {{ my_docs_create|length }}ë¶€, ì œì¶œëœ ë¬¸ì„œ {{ my_docs_submit|length }}ë¶€, ë°˜ë ¤ëœ ë¬¸ì„œ {{ my_docs_reject|length }}ë¶€</b>ë¥¼
                                            {% endif %}
                                            ë¨¼ì € ì²˜ë¦¬í•´ì£¼ì„¸ìš”.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% else %}
                            <div class="col">
                                <div class="shadow-sm h-100">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-weight: 600; color: #58595B;">ğŸ“„ ì‚­ì œë  ë¬¸ì„œ</h5>
                                        <p class="card-text">
                                            {{ user.first_name }}ë‹˜ì´ ìƒì„±í•˜ì‹  ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endif %}

        {% for account in user.socialaccount_set.all %}
            <form id="deleteLast" action="{% url 'users:delete' user.id %}" method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
                {% csrf_token %}
                {% if my_boxes|length > 0 or my_docs_create or my_docs_submit or my_docs_reject %}
                {% else %}
                    <div class="form-group mt-4">
                        <label for="confirm" class="form-label">ì˜êµ¬ ì‚­ì œ í™•ì¸<span style="color: #007DC5; font-weight: 600;"> *</span></label>
                        <input type="text" class="form-control" name="confirm" id="confirm" placeholder="'ì˜êµ¬ ì‚­ì œ í™•ì¸'ì´ë¼ê³  ì…ë ¥í•˜ì„¸ìš”." required>
                        <div class="invalid-feedback">ê·¸ëŒ€ë¡œ ì…ë ¥í•˜ì„¸ìš”.</div>
                    </div>
                {% endif %}
                <div class="container-md mt-5 p-0 d-grid gap-2 d-sm-flex justify-content-sm-end">
                    {% if my_boxes|length > 0 or my_docs_create or my_docs_submit or my_docs_reject %}
                        <button type="button" class="btn btn-outline-danger" disabled>ì‚­ì œ ë¶ˆê°€</button>
                    {% else %}
                        <button type="submit" class="btn btn-outline-danger submit">ì‚­ì œí•˜ê¸°</button>
                    {% endif %}
                    <button type="button" class="btn btn-outline-secondary" onclick="inProgress(); location.href='{% url 'users:myaccount' user.id %}'; innerText='â³ ì·¨ì†Œí•˜ê¸°';">ì·¨ì†Œí•˜ê¸°</button>
                </div>
            </form>
            <!-- Forms Validation -->
            <script>
                // Disable form submissions if there are invalid fields
                (function() {
                    'use strict';
                    window.addEventListener('load', function() {
                    // Get the forms we want to add validation styles to
                    var forms = document.getElementsByClassName('needs-validation');
                    // Loop over them and prevent submission
                    var validation = Array.prototype.filter.call(forms, function(form) {
                        form.addEventListener('submit', function(event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                        }, false);
                    });
                    }, false);
                })();
            </script>
            <!-- Image Validation -->
            <script>
                window.onerror = function(){
                    return true;
                }
                var _URL = window.URL || window.webkitURL;
                $("#deleteLast").submit( function( e ) {
                    var form = this;
                    e.preventDefault();
                    if ( document.querySelector("#confirm").value == 'ì˜êµ¬ ì‚­ì œ í™•ì¸' ) {
                        for (var i = 0; i < document.querySelectorAll(".btn").length; i++) {
                            document.querySelectorAll(".btn")[i].disabled = true;
                        }
                        document.querySelector(".submit").innerText = 'â³ ì‚­ì œí•˜ê¸°';
                        return form.submit();
                    } else {
                        alert("'ì˜êµ¬ ì‚­ì œ í™•ì¸'ì´ë¼ê³  ì…ë ¥í•˜ì„¸ìš”.")
                        document.querySelector("#confirm").value = '';
                        return false;
                    }
                });
            </script>
        {% empty %}
        {% endfor %}

    </div>

    </div>
</main>
{% endblock %}